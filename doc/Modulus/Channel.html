<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: Modulus::Channel</title>

	<link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

	<script src="../js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="../includes/channel_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="includes/channel.rb">includes/channel.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link"><a href="../Object.html">Object</a></p>
				
			</div>
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#method-c-new">::new</a></li>
					
					<li><a href="#method-i-is_op%3F">#is_op?</a></li>
					
					<li><a href="#method-i-join">#join</a></li>
					
					<li><a href="#method-i-modes">#modes</a></li>
					
					<li><a href="#method-i-topic">#topic</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
		</div>

		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="../LICENSE.html">LICENSE</a></li>
				
					<li class="file"><a href="../README.html">README</a></li>
				
					<li class="file"><a href="../Rakefile.html">Rakefile</a></li>
				
					<li class="file"><a href="../head.html">head</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="../images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="../Modulus.html">Modulus</a></li>
				
					<li><a href="../Modulus/Account.html">Modulus::Account</a></li>
				
					<li><a href="../Modulus/BanServ.html">Modulus::BanServ</a></li>
				
					<li><a href="../Modulus/BanServ/Autokill.html">Modulus::BanServ::Autokill</a></li>
				
					<li><a href="../Modulus/BanServ/Regexkill.html">Modulus::BanServ::Regexkill</a></li>
				
					<li><a href="../Modulus/BotServ.html">Modulus::BotServ</a></li>
				
					<li><a href="../Modulus/BotServ/BotServBot.html">Modulus::BotServ::BotServBot</a></li>
				
					<li><a href="../Modulus/BotServ/BotServChannel.html">Modulus::BotServ::BotServChannel</a></li>
				
					<li><a href="../Modulus/ChanServ.html">Modulus::ChanServ</a></li>
				
					<li><a href="../Modulus/ChanServ/Channel.html">Modulus::ChanServ::Channel</a></li>
				
					<li><a href="../Modulus/ChanServ/ChannelUsers.html">Modulus::ChanServ::ChannelUsers</a></li>
				
					<li><a href="../Modulus/Channel.html">Modulus::Channel</a></li>
				
					<li><a href="../Modulus/ChannelUser.html">Modulus::ChannelUser</a></li>
				
					<li><a href="../Modulus/Channels.html">Modulus::Channels</a></li>
				
					<li><a href="../Modulus/Clients.html">Modulus::Clients</a></li>
				
					<li><a href="../Modulus/Command.html">Modulus::Command</a></li>
				
					<li><a href="../Modulus/Config.html">Modulus::Config</a></li>
				
					<li><a href="../Modulus/EventCallback.html">Modulus::EventCallback</a></li>
				
					<li><a href="../Modulus/Events.html">Modulus::Events</a></li>
				
					<li><a href="../Modulus/Hook.html">Modulus::Hook</a></li>
				
					<li><a href="../Modulus/HostServ.html">Modulus::HostServ</a></li>
				
					<li><a href="../Modulus/HostServ/Host.html">Modulus::HostServ::Host</a></li>
				
					<li><a href="../Modulus/Log.html">Modulus::Log</a></li>
				
					<li><a href="../Modulus/Module.html">Modulus::Module</a></li>
				
					<li><a href="../Modulus/ModuleManager.html">Modulus::ModuleManager</a></li>
				
					<li><a href="../Modulus/NickServ.html">Modulus::NickServ</a></li>
				
					<li><a href="../Modulus/NickServ/Account.html">Modulus::NickServ::Account</a></li>
				
					<li><a href="../Modulus/NickServ/Nick.html">Modulus::NickServ::Nick</a></li>
				
					<li><a href="../Modulus/OperServ.html">Modulus::OperServ</a></li>
				
					<li><a href="../Modulus/OriginInfo.html">Modulus::OriginInfo</a></li>
				
					<li><a href="../Modulus/Parser.html">Modulus::Parser</a></li>
				
					<li><a href="../Modulus/ProtocolAbstraction.html">Modulus::ProtocolAbstraction</a></li>
				
					<li><a href="../Modulus/ProtocolAbstractionMixin.html">Modulus::ProtocolAbstractionMixin</a></li>
				
					<li><a href="../Modulus/Pseudoclient.html">Modulus::Pseudoclient</a></li>
				
					<li><a href="../Modulus/QuoteServ.html">Modulus::QuoteServ</a></li>
				
					<li><a href="../Modulus/QuoteServ/Quote.html">Modulus::QuoteServ::Quote</a></li>
				
					<li><a href="../Modulus/QuoteServ/QuoteChannel.html">Modulus::QuoteServ::QuoteChannel</a></li>
				
					<li><a href="../Modulus/QuoteServ/QuoteRater.html">Modulus::QuoteServ::QuoteRater</a></li>
				
					<li><a href="../Modulus/ReservedNick.html">Modulus::ReservedNick</a></li>
				
					<li><a href="../Modulus/Service.html">Modulus::Service</a></li>
				
					<li><a href="../Modulus/ServiceModules.html">Modulus::ServiceModules</a></li>
				
					<li><a href="../Modulus/User.html">Modulus::User</a></li>
				
					<li><a href="../Modulus/Users.html">Modulus::Users</a></li>
				
					<li><a href="../Object.html">Object</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">Modulus::Channel</h1>

		<div id="description">
			
		</div>

		<!-- Constants -->
		

		<!-- Attributes -->
		
		<div id="attribute-method-details" class="method-section section">
			<h3 class="section-header">Attributes</h3>

			
			<div id="name-attribute-method" class="method-detail">
				<a name="name"></a>
				
				<div class="method-heading attribute-method-heading">
					<span class="method-name">name</span><span
						class="attribute-access-type">[R]</span>
				</div>

				<div class="method-description">
				
				
				
				</div>
			</div>
			
			<div id="topic-attribute-method" class="method-detail">
				<a name="topic"></a>
				
				<div class="method-heading attribute-method-heading">
					<span class="method-name">topic</span><span
						class="attribute-access-type">[R]</span>
				</div>

				<div class="method-description">
				
				
				
				</div>
			</div>
			
			<div id="modes-attribute-method" class="method-detail">
				<a name="modes"></a>
				
				<div class="method-heading attribute-method-heading">
					<span class="method-name">modes</span><span
						class="attribute-access-type">[R]</span>
				</div>

				<div class="method-description">
				
				
				
				</div>
			</div>
			
			<div id="bans-attribute-method" class="method-detail">
				<a name="bans"></a>
				
				<div class="method-heading attribute-method-heading">
					<span class="method-name">bans</span><span
						class="attribute-access-type">[R]</span>
				</div>

				<div class="method-description">
				
				
				
				</div>
			</div>
			
			<div id="users-attribute-method" class="method-detail">
				<a name="users"></a>
				
				<div class="method-heading attribute-method-heading">
					<span class="method-name">users</span><span
						class="attribute-access-type">[R]</span>
				</div>

				<div class="method-description">
				
				
				
				</div>
			</div>
			
		</div>
		

		<!-- Methods -->
		
		<div id="public-class-method-details" class="method-section section">
			<h3 class="section-header">Public Class Methods</h3>

		
			<div id="new-method" class="method-detail ">
				<a name="method-c-new"></a>

				<div class="method-heading">
				
					<span class="method-name">new</span><span
						class="method-args">(name)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Record the existence of a new channel. The only parameter is the channel
name. Data structures for related data are initialized empty.
</p>
					

					
					<div class="method-source-code"
						id="new-source">
<pre>
    <span class="ruby-comment cmt"># File includes/channel.rb, line 29</span>
29:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">name</span>)
30:       <span class="ruby-ivar">@name</span> = <span class="ruby-identifier">name</span>
31:       <span class="ruby-ivar">@topic</span> = <span class="ruby-value str">&quot;&quot;</span>
32:       <span class="ruby-ivar">@modes</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
33:       <span class="ruby-ivar">@bans</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
34:       <span class="ruby-ivar">@users</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
35:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="is-op--method" class="method-detail ">
				<a name="method-i-is_op%3F"></a>

				<div class="method-heading">
				
					<span class="method-name">is_op?</span><span
						class="method-args">(nick)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Check if the given nick is a channel operator (or better, depenending on
IRCD.)
</p>
					

					
					<div class="method-source-code"
						id="is-op--source">
<pre>
     <span class="ruby-comment cmt"># File includes/channel.rb, line 117</span>
117:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_op?</span>(<span class="ruby-identifier">nick</span>)
118:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@users</span>.<span class="ruby-identifier">has_key?</span> <span class="ruby-identifier">nick</span>
119:         <span class="ruby-identifier">modes</span> = <span class="ruby-ivar">@users</span>[<span class="ruby-identifier">nick</span>].<span class="ruby-identifier">modes</span>
120:         <span class="ruby-keyword kw">return</span> (<span class="ruby-identifier">modes</span>.<span class="ruby-identifier">include?</span> <span class="ruby-value">:op</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">modes</span>.<span class="ruby-identifier">include?</span> <span class="ruby-value">:protected</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">modes</span>.<span class="ruby-identifier">include?</span> <span class="ruby-value">:owner</span>)
121:       <span class="ruby-keyword kw">end</span>
122: 
123:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
124:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="join-method" class="method-detail ">
				<a name="method-i-join"></a>

				<div class="method-heading">
				
					<span class="method-name">join</span><span
						class="method-args">(nick)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Add a nick to this channel&#8217;s list of users. The user will be stored
by nick as a <a href="ChannelUser.html">ChannelUser</a> object inside
@users. This is accessible by the read-only accessor users.
</p>
					

					
					<div class="method-source-code"
						id="join-source">
<pre>
    <span class="ruby-comment cmt"># File includes/channel.rb, line 42</span>
42:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">join</span>(<span class="ruby-identifier">nick</span>)
43:       <span class="ruby-ivar">@users</span>[<span class="ruby-identifier">nick</span>] = <span class="ruby-constant">ChannelUser</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">nick</span>)
44:       <span class="ruby-identifier">$log</span>.<span class="ruby-identifier">debug</span> <span class="ruby-value str">'channel'</span>, <span class="ruby-node">&quot;User #{nick} has joined #{@name}.&quot;</span>
45:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="modes-method" class="method-detail ">
				<a name="method-i-modes"></a>

				<div class="method-heading">
				
					<span class="method-name">modes</span><span
						class="method-args">(modes, params)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
When new modes are set for the channel, this is called. The parameters are
the modes and any parameters included with them. The protocol&#8217;s list
of channel user modes is used here to determine which modes can be applied
to users. The channel modes list determines which can have paramters. The
rest of the modes are stored alone.
</p>
					

					
					<div class="method-source-code"
						id="modes-source">
<pre>
     <span class="ruby-comment cmt"># File includes/channel.rb, line 62</span>
 62:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">modes</span>(<span class="ruby-identifier">modes</span>, <span class="ruby-identifier">params</span>)
 63:       <span class="ruby-identifier">plus</span> = <span class="ruby-keyword kw">true</span>
 64: 
 65:       <span class="ruby-identifier">paramModes</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
 66: 
 67:       <span class="ruby-identifier">pos</span> = <span class="ruby-value">0</span>
 68: 
 69:       <span class="ruby-comment cmt"># Let's break the mode string down one character at a time.</span>
 70:       <span class="ruby-identifier">modes</span>.<span class="ruby-identifier">each_char</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
 71:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;+&quot;</span>
 72:           <span class="ruby-identifier">plus</span> = <span class="ruby-keyword kw">true</span>
 73:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;-&quot;</span>
 74:           <span class="ruby-identifier">plus</span> = <span class="ruby-keyword kw">false</span>
 75:         <span class="ruby-keyword kw">else</span>
 76: 
 77:           <span class="ruby-comment cmt"># Is it a channel mode that can apply to a user? (such as +o)</span>
 78:           <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Modulus</span>.<span class="ruby-identifier">link</span>.<span class="ruby-identifier">channelUserModes</span>.<span class="ruby-identifier">has_key?</span> <span class="ruby-identifier">c</span>
 79:             <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@users</span>.<span class="ruby-identifier">has_key?</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">pos</span>]
 80:               <span class="ruby-ivar">@users</span>[<span class="ruby-identifier">params</span>[<span class="ruby-identifier">pos</span>]].<span class="ruby-identifier">modeChange</span>(<span class="ruby-identifier">plus</span>, <span class="ruby-constant">Modulus</span>.<span class="ruby-identifier">link</span>.<span class="ruby-identifier">channelUserModes</span>[<span class="ruby-identifier">c</span>])
 81:               <span class="ruby-identifier">$log</span>.<span class="ruby-identifier">debug</span> <span class="ruby-value str">'channel'</span>, <span class="ruby-node">&quot;params: #{params} paramModes: #{paramModes}&quot;</span>
 82:             <span class="ruby-keyword kw">else</span>
 83:               <span class="ruby-identifier">$log</span>.<span class="ruby-identifier">warning</span> <span class="ruby-value str">'channel'</span>, <span class="ruby-node">&quot;Could not find nick #{params[pos]} in channel user list for #{@name} when doing mode change.&quot;</span>
 84:             <span class="ruby-keyword kw">end</span>
 85:             <span class="ruby-identifier">pos</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
 86: 
 87:           <span class="ruby-comment cmt"># It can't apply to a user. Let's only accept it if it is in the</span>
 88:           <span class="ruby-comment cmt"># list of modes, anyway.</span>
 89:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">Modulus</span>.<span class="ruby-identifier">link</span>.<span class="ruby-identifier">channelModes</span>.<span class="ruby-identifier">has_key?</span> <span class="ruby-identifier">c</span>
 90: 
 91:             <span class="ruby-comment cmt"># Can this mode have a parameter? (such as +k key)</span>
 92:             <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Modulus</span>.<span class="ruby-identifier">link</span>.<span class="ruby-identifier">channelModes</span>[<span class="ruby-identifier">c</span>]
 93:               <span class="ruby-identifier">param</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">pos</span>]
 94:               <span class="ruby-identifier">pos</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
 95:             <span class="ruby-keyword kw">else</span>
 96:               <span class="ruby-identifier">param</span> = <span class="ruby-keyword kw">nil</span>
 97:             <span class="ruby-keyword kw">end</span>
 98: 
 99:             <span class="ruby-identifier">$log</span>.<span class="ruby-identifier">debug</span> <span class="ruby-value str">'channel'</span>, <span class="ruby-node">&quot;mode key: #{c} mode value: #{param}&quot;</span>
100: 
101:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">plus</span>
102:               <span class="ruby-ivar">@modes</span>[<span class="ruby-identifier">c</span>] = <span class="ruby-identifier">param</span>
103:             <span class="ruby-keyword kw">else</span>
104:               <span class="ruby-ivar">@modes</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">c</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@modes</span>.<span class="ruby-identifier">has_key?</span> <span class="ruby-identifier">c</span>
105:             <span class="ruby-keyword kw">end</span>
106:           <span class="ruby-keyword kw">end</span>
107:         <span class="ruby-keyword kw">end</span>
108:       }
109: 
110:       <span class="ruby-identifier">$log</span>.<span class="ruby-identifier">debug</span> <span class="ruby-value str">'channel'</span>, <span class="ruby-node">&quot;Updated modes for #{@name}&quot;</span>
111:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="topic-method" class="method-detail ">
				<a name="method-i-topic"></a>

				<div class="method-heading">
				
					<span class="method-name">topic</span><span
						class="method-args">(topic)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Called when a new topic is set for this channel.
</p>
					

					
					<div class="method-source-code"
						id="topic-source">
<pre>
    <span class="ruby-comment cmt"># File includes/channel.rb, line 50</span>
50:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">topic</span>(<span class="ruby-identifier">topic</span>)
51:       <span class="ruby-ivar">@topic</span> = <span class="ruby-identifier">topic</span>
52:       <span class="ruby-comment cmt"># TODO: Fire an event here?</span>
53:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

